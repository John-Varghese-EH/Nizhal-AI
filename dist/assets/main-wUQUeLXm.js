const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./VRMAvatar-DysJ1kvm.js","./animation-Bl1i2YEf.js","./react-vendor-DIqo-C3o.js","./three-CwDwxXp6.js","./GLTFLoader-3dBYMb61.js","./three-vrm.module-BHw-iIqj.js","./OrbitControls-CFX3C8mP.js"])))=>i.map(i=>d[i]);
import{_ as te,R as se}from"./globals-_YYcdJxc.js";import{j as e,m as n,A as F}from"./animation-Bl1i2YEf.js";import{a as r,R as ae,B as ie}from"./react-vendor-DIqo-C3o.js";import{C as ne,u as le,a as K,R as re,D as oe,S as ce,b as de}from"./three-CwDwxXp6.js";const he=({personaName:l,clickThrough:c,onClickThroughToggle:s})=>{const a=()=>{var x;return(x=window.nizhal)==null?void 0:x.window.minimize()},o=()=>{var x;return(x=window.nizhal)==null?void 0:x.window.maximize()},m=()=>{var x;return(x=window.nizhal)==null?void 0:x.window.close()};return e.jsxs("div",{className:"h-10 flex items-center justify-between px-3 drag-region bg-black/20 border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 no-drag",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-white/90",children:l})]}),e.jsxs("div",{className:"flex items-center gap-1 no-drag",children:[e.jsx(n.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:s,className:`p-1.5 rounded-md transition-colors ${c?"bg-indigo-500/30 text-indigo-300":"hover:bg-white/10 text-white/60"}`,title:c?"Disable Click-Through":"Enable Click-Through",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:c?"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z":"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M3 3l18 18"})})}),e.jsx(n.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:a,className:"p-1.5 rounded-md hover:bg-white/10 text-white/60 hover:text-white",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx(n.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:o,className:"p-1.5 rounded-md hover:bg-white/10 text-white/60 hover:text-white",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsx(n.button,{whileHover:{scale:1.1,backgroundColor:"rgba(239, 68, 68, 0.3)"},whileTap:{scale:.9},onClick:m,className:"p-1.5 rounded-md hover:bg-red-500/20 text-white/60 hover:text-red-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})},xe=({persona:l,personalityState:c})=>{const[s,a]=r.useState([]),[o,m]=r.useState(""),[x,p]=r.useState(!1),[j,N]=r.useState(!1),v=r.useRef(null),w=r.useRef(null);r.useEffect(()=>{z()},[]),r.useEffect(()=>{b()},[s]);const z=async()=>{var h;try{const f=await((h=window.nizhal)==null?void 0:h.memory.getHistory(20));if(f&&f.length>0){const I=f.flatMap(S=>[{role:"user",content:S.userMessage,timestamp:S.timestamp},{role:"assistant",content:S.aiResponse,timestamp:S.timestamp}]);a(I)}else a([{role:"assistant",content:M(),timestamp:Date.now()}])}catch(f){console.error("Failed to load history:",f)}},M=()=>({jarvis:"Good day. I am at your service. How may I assist you?",thozhi:"Hey! Sugham aano? Njan ivideyundu, samsarikku! â¤ï¸",thozhan:"Machane! Enthu vishesham? Ready aanu njan!"})[l==null?void 0:l.id]||"Hello! I'm Nizhal AI. How can I help you today?",b=()=>{var h;(h=v.current)==null||h.scrollIntoView({behavior:"smooth"})},P=async h=>{var I,S,k;if(h.preventDefault(),!o.trim()||x)return;const f=o.trim();m(""),a(y=>[...y,{role:"user",content:f,timestamp:Date.now()}]),p(!0),N(!0);try{const y=await((I=window.nizhal)==null?void 0:I.ai.chat(f));if(y!=null&&y.success){a(L=>[...L,{role:"assistant",content:y.response,timestamp:Date.now()}]);const C=await((S=window.nizhal)==null?void 0:S.memory.getUserPreferences());C!=null&&C.voiceEnabled&&await((k=window.nizhal)==null?void 0:k.voice.speak(y.response))}else a(C=>[...C,{role:"assistant",content:(y==null?void 0:y.error)||"I encountered an issue. Please try again.",timestamp:Date.now(),isError:!0}])}catch(y){console.error("Chat error:",y),a(C=>[...C,{role:"assistant",content:"Connection error. Please check your AI provider settings.",timestamp:Date.now(),isError:!0}])}finally{p(!1),N(!1)}},i=()=>({happy:"ðŸ˜Š",neutral:"ðŸ¤–",concerned:"ðŸ˜Ÿ",protective:"ðŸ›¡ï¸",playful:"ðŸ˜„",thoughtful:"ðŸ¤”"})[c==null?void 0:c.mood]||"ðŸ¤–";return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsx(F,{initial:!1,children:s.map((h,f)=>e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:`flex ${h.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] rounded-2xl px-4 py-3 ${h.role==="user"?"bg-indigo-600 text-white rounded-br-sm":h.isError?"bg-red-500/20 text-red-300 border border-red-500/30 rounded-bl-sm":"bg-white/10 text-white/90 rounded-bl-sm"}`,children:[h.role==="assistant"&&!h.isError&&e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-xs text-white/50",children:[e.jsx("span",{children:i()}),e.jsx("span",{children:(l==null?void 0:l.name)||"AI"})]}),e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:h.content})]})},f))}),j&&e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:e.jsx("div",{className:"bg-white/10 rounded-2xl rounded-bl-sm px-4 py-3",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2].map(h=>e.jsx(n.div,{className:"w-2 h-2 bg-indigo-400 rounded-full",animate:{y:[0,-8,0]},transition:{duration:.6,repeat:1/0,delay:h*.1}},h))})})}),e.jsx("div",{ref:v})]}),e.jsx("form",{onSubmit:P,className:"p-4 border-t border-white/5",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{ref:w,type:"text",value:o,onChange:h=>m(h.target.value),placeholder:`Message ${(l==null?void 0:l.name)||"AI"}...`,disabled:x,className:"flex-1 bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white placeholder-white/30 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30 transition-all disabled:opacity-50"}),e.jsx(n.button,{type:"submit",disabled:x||!o.trim(),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-3 bg-indigo-600 hover:bg-indigo-700 disabled:bg-white/10 rounded-xl transition-colors disabled:cursor-not-allowed",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})},me=({onBack:l})=>{var b,P;const[c,s]=r.useState([]),[a,o]=r.useState(null),[m,x]=r.useState(!1),[p,j]=r.useState(null),[N,v]=r.useState(!0);r.useEffect(()=>{w()},[]);const w=async()=>{var i;try{const h=await((i=window.nizhal)==null?void 0:i.marketplace.getPersonas());s(h||[])}catch(h){console.error("Failed to load personas:",h)}finally{v(!1)}},z=async(i,h)=>{var f;x(!0),j(null);try{const I=await((f=window.nizhal)==null?void 0:f.marketplace.purchase(i,h));j(I),I!=null&&I.success&&await w()}catch(I){j({success:!1,error:I.message})}finally{x(!1)}},M=i=>{const h={free:"bg-green-500/20 text-green-400 border-green-500/30",pro:"bg-purple-500/20 text-purple-400 border-purple-500/30",elite:"bg-amber-500/20 text-amber-400 border-amber-500/30",ultimate:"bg-rose-500/20 text-rose-400 border-rose-500/30"};return h[i]||h.free};return N?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(n.div,{className:"w-10 h-10 border-3 border-indigo-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/5",children:[e.jsx("h2",{className:"text-lg font-semibold gradient-text",children:"Persona Marketplace"}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:"Unlock new companions and features"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:c.map(i=>e.jsxs(n.div,{layoutId:i.id,whileHover:{scale:1.02},onClick:()=>o(i),className:"bg-white/5 rounded-xl p-4 border border-white/10 cursor-pointer hover:border-indigo-500/50 transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-white",children:i.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full border ${M(i.tier)}`,children:i.tier.toUpperCase()}),i.unlocked&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400",children:"âœ“ Owned"})]}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:i.description})]}),!i.unlocked&&i.price&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-indigo-400",children:["$",i.price.usd]}),e.jsxs("div",{className:"text-xs text-white/40",children:["â‚¹",i.price.inr]})]})]}),i.features&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:i.features.slice(0,3).map((h,f)=>e.jsx("span",{className:"text-xs bg-white/5 px-2 py-1 rounded-md text-white/60",children:h},f))})]},i.id))}),e.jsx(F,{children:a&&e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>o(null),children:e.jsxs(n.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:i=>i.stopPropagation(),className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:a.name}),e.jsx("button",{onClick:()=>o(null),className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("p",{className:"text-sm text-white/60 mb-4",children:a.description}),a.features&&e.jsx("div",{className:"space-y-2 mb-6",children:a.features.map((i,h)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/80",children:[e.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),i]},h))}),p&&e.jsx("div",{className:`mb-4 p-3 rounded-lg text-sm ${p.success?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:p.success?"âœ“ Purchase successful! Persona unlocked.":p.cancelled?"Purchase cancelled.":`Error: ${p.error}`}),a.unlocked?e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{var i;(i=window.nizhal)==null||i.persona.setActive(a.id),o(null)},className:"w-full py-3 bg-green-600 hover:bg-green-700 text-white font-medium rounded-xl transition-colors",children:"Activate Persona"}):a.tier==="free"?e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{var i;(i=window.nizhal)==null||i.persona.setActive(a.id),o(null)},className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-xl transition-colors",children:"Use Now (Free)"}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>z(a.id,"razorpay"),disabled:m,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white font-medium rounded-xl transition-colors flex items-center justify-center gap-2",children:m?e.jsx(n.div,{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}):e.jsxs(e.Fragment,{children:["Pay â‚¹",(b=a.price)==null?void 0:b.inr," (India)"]})}),e.jsxs(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>z(a.id,"stripe"),disabled:m,className:"w-full py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-700 text-white font-medium rounded-xl transition-colors",children:["Pay $",(P=a.price)==null?void 0:P.usd," (International)"]})]})]})})})]})},ue=({onBack:l,onPersonaChange:c})=>{var U,J,Q,Y,Z;const[s,a]=r.useState({}),[o,m]=r.useState([]),[x,p]=r.useState("jarvis"),[j,N]=r.useState(!1),[v,w]=r.useState(null),[z,M]=r.useState(""),[b,P]=r.useState([]),[i,h]=r.useState(null),[f,I]=r.useState("general");r.useEffect(()=>{S()},[]);const S=async()=>{var t,d,u,g,E;try{const $=await((t=window.nizhal)==null?void 0:t.memory.getUserPreferences()),W=await((d=window.nizhal)==null?void 0:d.persona.getAll()),V=await((u=window.nizhal)==null?void 0:u.persona.getActive()),q=await((g=window.nizhal)==null?void 0:g.ai.getProviders()),ee=await((E=window.nizhal)==null?void 0:E.ai.getProviderStatus());a($||{}),m(W||[]),p((V==null?void 0:V.id)||"jarvis"),P(q||[]),h(ee||{})}catch($){console.error("Failed to load settings:",$)}},k=async(t,d)=>{var u;N(!0);try{const g={...s,[t]:d};await((u=window.nizhal)==null?void 0:u.memory.setUserPreferences(g)),a(g)}catch(g){console.error("Failed to save preference:",g)}finally{N(!1)}},y=async t=>{var d;try{const u=await((d=window.nizhal)==null?void 0:d.persona.setActive(t));p(t),c==null||c(u)}catch(u){console.error("Failed to switch persona:",u)}},C=async()=>{var t,d,u,g;if(!(!v||!z.trim())){N(!0);try{const E={...s.apiKeys,[v]:z.trim()};await((t=window.nizhal)==null?void 0:t.memory.setUserPreferences({apiKeys:E})),a(V=>({...V,apiKeys:E})),await((d=window.nizhal)==null?void 0:d.ai.setProvider(v,{apiKey:z.trim()}));const $=await((u=window.nizhal)==null?void 0:u.ai.getProviderStatus()),W=await((g=window.nizhal)==null?void 0:g.ai.getProviders());h($),P(W),w(null),M("")}catch(E){console.error("Failed to save API key:",E)}finally{N(!1)}}},L=async t=>{var d,u;N(!0);try{await((d=window.nizhal)==null?void 0:d.ai.setProvider(t,{})),await k("aiProvider",t);const g=await((u=window.nizhal)==null?void 0:u.ai.getProviderStatus());h(g)}catch(g){console.error("Failed to set provider:",g)}finally{N(!1)}},H=async t=>{var d,u;try{await((d=window.nizhal)==null?void 0:d.ai.setFallbackEnabled(t)),await k("enableFallback",t);const g=await((u=window.nizhal)==null?void 0:u.ai.getProviderStatus());h(g)}catch(g){console.error("Failed to toggle fallback:",g)}},B=async()=>{var u,g;const t=await((u=window.nizhal)==null?void 0:u.ai.checkLocalAI()),d=await((g=window.nizhal)==null?void 0:g.ai.getProviderStatus());return h(d),t},R=t=>{var d;(d=window.nizhal)==null||d.app.openExternal(t)},T=({label:t,description:d,children:u})=>e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:t}),d&&e.jsx("div",{className:"text-xs text-white/40 mt-0.5",children:d})]}),e.jsx("div",{className:"flex-shrink-0",children:u})]}),A=({enabled:t,onChange:d})=>e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>d(!t),className:`relative w-12 h-6 rounded-full transition-colors ${t?"bg-indigo-600":"bg-white/20"}`,children:e.jsx(n.div,{className:"absolute top-1 w-4 h-4 bg-white rounded-full",animate:{left:t?"26px":"4px"},transition:{type:"spring",stiffness:500,damping:30}})}),G=({available:t,configured:d})=>t?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-green-400",children:[e.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})," Connected"]}):d?e.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-yellow-400",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-400 rounded-full"})," Configured"]}):e.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-white/30",children:[e.jsx("span",{className:"w-2 h-2 bg-white/30 rounded-full"})," Not set"]}),O=({id:t,label:d,active:u})=>e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>I(t),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${u?"bg-indigo-600 text-white":"text-white/60 hover:text-white hover:bg-white/5"}`,children:d}),_=[{id:"gemini",name:"Google Gemini",description:"Free tier available",url:"https://aistudio.google.com/app/apikey"},{id:"openai",name:"OpenAI",description:"GPT-4o models",url:"https://platform.openai.com/api-keys"},{id:"anthropic",name:"Anthropic",description:"Claude models",url:"https://console.anthropic.com/settings/keys"},{id:"elevenlabs",name:"ElevenLabs",description:"Premium voice synthesis",url:"https://elevenlabs.io/api"}];return e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/5",children:[e.jsx("h2",{className:"text-lg font-semibold gradient-text",children:"Settings"}),e.jsx("p",{className:"text-xs text-white/50 mt-1",children:"Customize your Nizhal AI experience"})]}),e.jsxs("div",{className:"px-4 py-2 flex gap-2 border-b border-white/5 overflow-x-auto",children:[e.jsx(O,{id:"general",label:"General",active:f==="general"}),e.jsx(O,{id:"character",label:"Character",active:f==="character"}),e.jsx(O,{id:"ai",label:"AI Providers",active:f==="ai"}),e.jsx(O,{id:"voice",label:"Voice",active:f==="voice"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>R("https://www.buymeacoffee.com/nizhalai"),className:"w-full py-4 px-4 bg-gradient-to-r from-amber-500 to-orange-500 rounded-xl flex items-center justify-center gap-3 text-white font-medium shadow-lg shadow-orange-500/25",children:[e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20.216 6.415l-.132-.666c-.119-.598-.388-1.163-1.001-1.379-.197-.069-.42-.098-.57-.241-.152-.143-.196-.366-.231-.572-.065-.378-.125-.756-.192-1.133-.057-.325-.102-.69-.25-.987-.195-.4-.597-.634-.996-.788a5.723 5.723 0 00-.626-.194c-1-.263-2.05-.36-3.077-.416a25.834 25.834 0 00-3.7.062c-.915.083-1.88.184-2.75.5-.318.116-.646.256-.888.501-.297.302-.393.77-.177 1.146.154.267.415.456.692.58.36.162.737.284 1.123.366 1.075.238 2.189.331 3.287.37 1.218.05 2.437.01 3.65-.118.299-.033.598-.073.896-.119.352-.054.578-.513.474-.834-.124-.383-.457-.531-.834-.473-.466.074-.96.108-1.382.146-1.177.08-2.358.082-3.536.006a22.228 22.228 0 01-1.157-.107c-.086-.01-.18-.025-.258-.036-.243-.036-.484-.08-.724-.13-.111-.027-.111-.185 0-.212h.005c.277-.06.557-.108.838-.147h.002c.131-.009.263-.032.394-.048a25.076 25.076 0 013.426-.12c.674.019 1.347.067 2.017.144l.228.031c.267.04.533.088.798.145.392.085.895.113 1.07.542.055.137.08.288.111.431l.319 1.484a.237.237 0 01-.199.284h-.003c-.037.006-.075.01-.112.015a36.704 36.704 0 01-4.743.295 37.059 37.059 0 01-4.699-.304c-.14-.017-.293-.042-.417-.06-.326-.048-.649-.108-.973-.161-.393-.065-.768-.032-1.123.161-.29.16-.527.404-.675.701-.154.316-.199.66-.267 1-.069.34-.176.707-.135 1.056.087.753.613 1.365 1.37 1.502a39.69 39.69 0 0011.343.376.483.483 0 01.535.53l-.071.697-1.018 9.907c-.041.41-.047.832-.125 1.237-.122.637-.553 1.028-1.182 1.171-.577.131-1.165.185-1.756.205-.656.023-1.313-.019-1.969-.062-.661-.043-1.32-.104-1.979-.176-.289-.032-.554-.146-.7-.427-.148-.283-.148-.621-.085-.926.111-.533.32-1.017.596-1.468a21.265 21.265 0 011.783-2.456c.299-.355.614-.697.922-1.045.079-.09.154-.185.232-.276.208-.243.189-.589-.074-.773-.25-.175-.582-.137-.822.101-.336.334-.666.673-.988 1.021a23.234 23.234 0 00-2.189 2.851c-.431.66-.781 1.374-.975 2.148-.104.413-.143.846-.07 1.265.074.423.261.807.536 1.113.493.55 1.2.786 1.923.88.749.097 1.507.117 2.261.106.774-.012 1.549-.068 2.319-.16.696-.083 1.39-.206 2.03-.486.574-.252 1.112-.671 1.359-1.273.148-.358.215-.747.268-1.13l.052-.426c.015-.116.029-.232.041-.347l.902-8.765c.028-.266.058-.532.088-.797l.035-.318.024-.2.025-.236.034-.315.018-.162.009-.083c.005-.044.011-.088.016-.131.053-.441-.291-.844-.753-.918a43.422 43.422 0 01-2.693-.448 38.69 38.69 0 01-2.443-.55c-.212-.057-.424-.116-.636-.177-.146-.042-.293-.084-.439-.127-.072-.021-.143-.043-.213-.064-.034-.011-.067-.021-.1-.031h-.003l-.265-.082-.13-.041-.014-.004h-.002l-.016-.005-.028-.009-.064-.02a.486.486 0 01-.332-.597l.008-.027.016-.051.014-.046.01-.034c.112-.378.226-.757.35-1.132.132-.398.274-.793.433-1.18.083-.204.172-.405.266-.603a.514.514 0 01.456-.279h.005l.009.001.027.002.064.007.13.013.279.03c.147.016.294.031.442.046l.451.044c.149.014.298.028.448.041l.444.04c.147.012.294.024.442.035l.435.032.43.03.426.028.42.026.414.024.408.022.4.02.392.018.384.016.375.013.366.011.357.01h.346l.337.005h.656l.316-.003.306-.006z"})}),"Sponsor Nizhal AI â˜•"]}),e.jsxs(F,{mode:"wait",children:[f==="general"&&e.jsxs(n.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70 mb-3",children:"Active Persona"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:o.map(t=>e.jsxs(n.button,{whileTap:{scale:.95},onClick:()=>y(t.id),className:`p-3 rounded-xl text-center transition-all ${x===t.id?"bg-indigo-600 text-white":"bg-white/5 text-white/60 hover:bg-white/10"}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:{jarvis:"ðŸ¤–",kavya:"âœ¨",arjun:"ðŸ›¡ï¸",naruto:"ðŸ¦Š",goku:"ðŸ‰",elsa:"â„ï¸",tamil_nanban:"ðŸŽ­",telugu_sneham:"ðŸ¤",hindi_dost:"ðŸ•º"}[t.id]||"ðŸ‘¤"}),e.jsx("div",{className:"text-xs font-medium truncate",children:t.name})]},t.id))})]}),e.jsxs("div",{className:"space-y-1 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70 mb-3",children:"General"}),e.jsx(T,{label:"Voice Output",description:"Enable AI speech responses",children:e.jsx(A,{enabled:s.voiceEnabled,onChange:t=>k("voiceEnabled",t)})}),e.jsx(T,{label:"Always on Top",description:"Keep window above others",children:e.jsx(A,{enabled:s.alwaysOnTop,onChange:t=>{var d;k("alwaysOnTop",t),(d=window.nizhal)==null||d.window.setAlwaysOnTop(t)}})}),e.jsx(T,{label:"Start with Windows",description:"Launch on system startup",children:e.jsx(A,{enabled:s.startWithWindows,onChange:t=>k("startWithWindows",t)})})]}),e.jsxs("div",{className:"border-t border-white/5 pt-4 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Support & Links"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>R("https://patreon.com/nizhalai"),className:"p-3 bg-orange-500/10 border border-orange-500/20 rounded-xl text-orange-400 text-sm font-medium",children:"Patreon"}),e.jsx(n.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>R("https://github.com/nizhal-ai"),className:"p-3 bg-white/5 border border-white/10 rounded-xl text-white/70 text-sm font-medium",children:"GitHub"})]})]})]},"general"),f==="character"&&e.jsxs(n.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Character Model"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"jarvis",name:"Jarvis",icon:"ðŸ”®",desc:"Hologram"},{id:"zome",name:"Zome",icon:"ðŸ‘§",desc:"VRM"},{id:"lazuli",name:"Lazuli",icon:"ðŸ’«",desc:"VRM"},{id:"aldina",name:"Aldina",icon:"ðŸŒ¸",desc:"VRM"}].map(t=>e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>{var d,u,g;k("characterModel",t.id),(g=(u=(d=window.nizhal)==null?void 0:d.character)==null?void 0:u.setModel)==null||g.call(u,t.id)},className:`p-3 rounded-xl text-left transition-all ${s.characterModel===t.id?"bg-indigo-600/30 border-2 border-indigo-500":"bg-white/5 border border-white/10 hover:bg-white/10"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:t.name}),e.jsx("div",{className:"text-xs text-white/40",children:t.desc})]})]})},t.id))})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Display"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-white/60",children:"Size"}),e.jsxs("span",{className:"text-white/40",children:[(s.characterScale||1).toFixed(1),"x"]})]}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:s.characterScale||1,onChange:t=>k("characterScale",parseFloat(t.target.value)),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer accent-indigo-500"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-white/60",children:"Opacity"}),e.jsxs("span",{className:"text-white/40",children:[Math.round((s.characterOpacity||1)*100),"%"]})]}),e.jsx("input",{type:"range",min:"0.3",max:"1",step:"0.1",value:s.characterOpacity||1,onChange:t=>k("characterOpacity",parseFloat(t.target.value)),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer accent-indigo-500"})]}),e.jsx("div",{className:"flex gap-2",children:["low","medium","high"].map(t=>e.jsxs("button",{className:`flex-1 py-2 rounded-lg text-xs capitalize ${s.characterQuality===t?"bg-indigo-500/30 text-white":"bg-white/5 text-white/60 hover:bg-white/10"}`,onClick:()=>k("characterQuality",t),children:[t," Quality"]},t))})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Behavior"}),e.jsx(T,{label:"Enable Gravity",description:"Character falls and sits on taskbar",children:e.jsx(A,{enabled:s.enableGravity,onChange:t=>k("enableGravity",t)})}),e.jsx(T,{label:"Dance to Music",description:"Responds to audio beats",children:e.jsx(A,{enabled:s.enableDance!==!1,onChange:t=>k("enableDance",t)})}),e.jsx(T,{label:"Mouse Tracking",description:"Eyes follow cursor",children:e.jsx(A,{enabled:s.mouseTracking!==!1,onChange:t=>k("mouseTracking",t)})}),e.jsx(T,{label:"Auto Blink",description:"Natural blinking animation",children:e.jsx(A,{enabled:s.autoBlink!==!1,onChange:t=>k("autoBlink",t)})})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Quick Position"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{pos:"top-left",icon:"â†–ï¸"},{pos:"top-right",icon:"â†—ï¸"},{pos:"bottom-left",icon:"â†™ï¸"},{pos:"bottom-right",icon:"â†˜ï¸"}].map(({pos:t,icon:d})=>e.jsx("button",{className:"p-2 bg-white/5 hover:bg-white/10 rounded-lg text-lg",onClick:()=>{var u,g,E;return(E=(g=(u=window.nizhal)==null?void 0:u.character)==null?void 0:g.snap)==null?void 0:E.call(g,t)},children:d},t))})]})]},"character"),f==="ai"&&e.jsxs(n.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-indigo-500/10 to-purple-500/10 border border-indigo-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:"Active Provider"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-indigo-500/20 text-indigo-300 rounded-full",children:(i==null?void 0:i.currentProvider)||"auto"})]}),e.jsx("p",{className:"text-xs text-white/50",children:i!=null&&i.ollamaAvailable?"âœ“ Local AI available":"âœ— Local AI not running, using cloud providers"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Local AI (Ollama)"}),e.jsx(n.button,{whileTap:{scale:.95},onClick:B,className:"text-xs text-indigo-400 hover:text-indigo-300",children:"Refresh Status"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${i!=null&&i.ollamaAvailable?"bg-green-500/20":"bg-white/10"}`,children:e.jsx("span",{className:"text-xl",children:"ðŸ¦™"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"Ollama"}),e.jsx("div",{className:"text-xs text-white/40",children:"Free, private, runs locally"})]})]}),e.jsx(G,{available:i==null?void 0:i.ollamaAvailable,configured:!0})]}),!(i!=null&&i.ollamaAvailable)&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20",children:[e.jsx("p",{className:"text-xs text-yellow-300 mb-2",children:"Ollama is not running. Start it for free local AI:"}),e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>R("https://ollama.com"),className:"text-xs text-yellow-400 underline",children:"Download Ollama â†’"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Cloud Providers"}),e.jsx("div",{className:"space-y-2",children:b.filter(t=>t.id!=="ollama").map(t=>e.jsxs(n.div,{whileHover:{backgroundColor:"rgba(255,255,255,0.05)"},className:"p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${t.available?"bg-green-500/20":"bg-white/10"}`,children:[t.id==="gemini"&&e.jsx("span",{className:"text-xl",children:"âœ¨"}),t.id==="openai"&&e.jsx("span",{className:"text-xl",children:"ðŸ¤–"}),t.id==="anthropic"&&e.jsx("span",{className:"text-xl",children:"ðŸ§ "})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:t.name}),e.jsx("div",{className:"text-xs text-white/40",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{available:t.available,configured:t.configured}),e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>{var d;w(t.id),M(((d=s.apiKeys)==null?void 0:d[t.id])||"")},className:"text-xs px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-white/70",children:t.configured?"Edit":"Add Key"})]})]}),t.configured&&(i==null?void 0:i.currentProvider)!==t.id&&e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>L(t.id),className:"mt-3 w-full py-2 text-xs bg-indigo-500/20 hover:bg-indigo-500/30 text-indigo-300 rounded-lg",children:"Use as Primary"})]},t.id))})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Fallback Settings"}),e.jsx(T,{label:"Automatic Fallback",description:"Try other providers if primary fails",children:e.jsx(A,{enabled:(i==null?void 0:i.fallbackEnabled)??!0,onChange:H})}),e.jsx("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:e.jsxs("p",{className:"text-xs text-white/50",children:["Priority: ",((U=i==null?void 0:i.providerPriority)==null?void 0:U.join(" â†’ "))||"ollama â†’ gemini â†’ openai â†’ anthropic"]})})]})]},"ai"),f==="voice"&&e.jsxs(n.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Voice Input"}),e.jsx(T,{label:"Voice Commands",description:"Use microphone to talk to AI",children:e.jsx(A,{enabled:s.voiceInputEnabled,onChange:t=>k("voiceInputEnabled",t)})}),e.jsx(T,{label:"Wake Word",description:'Say "Hey Nizhal" to activate',children:e.jsx(A,{enabled:s.wakeWordEnabled,onChange:t=>k("wakeWordEnabled",t)})}),e.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[e.jsx("p",{className:"text-xs text-white/50 mb-2",children:"Supported languages:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:["English","Malayalam","Hindi","Tamil","Telugu"].map(t=>e.jsx("span",{className:"text-xs px-2 py-1 bg-white/10 rounded text-white/60",children:t},t))})]})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Voice Output"}),e.jsx(T,{label:"Enable Speech",description:"AI speaks responses aloud",children:e.jsx(A,{enabled:s.voiceEnabled,onChange:t=>k("voiceEnabled",t)})})]}),e.jsxs("div",{className:"space-y-3 border-t border-white/5 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-white/70",children:"Premium Voice (ElevenLabs)"}),e.jsxs(n.button,{whileHover:{backgroundColor:"rgba(255,255,255,0.05)"},onClick:()=>{var t;w("elevenlabs"),M(((t=s.apiKeys)==null?void 0:t.elevenlabs)||"")},className:"w-full flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${(J=s.apiKeys)!=null&&J.elevenlabs?"bg-green-500/20":"bg-white/10"}`,children:e.jsx("span",{className:"text-xl",children:"ðŸŽ™ï¸"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"ElevenLabs API"}),e.jsx("div",{className:"text-xs text-white/40",children:"Ultra-realistic AI voices"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[(Q=s.apiKeys)!=null&&Q.elevenlabs?e.jsx("span",{className:"text-xs text-green-400",children:"âœ“ Set"}):e.jsx("span",{className:"text-xs text-white/30",children:"Not set"}),e.jsx("svg",{className:"w-4 h-4 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]},"voice")]}),e.jsx("div",{className:"text-center text-xs text-white/30 pt-4",children:"Nizhal AI v1.0.0"})]})}),v&&e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:()=>w(null),children:e.jsxs(n.div,{initial:{scale:.9},animate:{scale:1},onClick:t=>t.stopPropagation(),className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full border border-white/10",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:((Y=_.find(t=>t.id===v))==null?void 0:Y.name)||"API Key"}),e.jsx("p",{className:"text-xs text-white/50 mb-4",children:(Z=_.find(t=>t.id===v))==null?void 0:Z.description}),e.jsx("input",{type:"password",value:z,onChange:t=>M(t.target.value),placeholder:"Enter your API key",className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-sm text-white placeholder-white/30 focus:outline-none focus:border-indigo-500/50 mb-3"}),e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>{var t;return R(((t=_.find(d=>d.id===v))==null?void 0:t.url)||"#")},className:"w-full text-xs text-indigo-400 hover:text-indigo-300 mb-4 text-left",children:"Get API key â†’"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n.button,{whileTap:{scale:.95},onClick:()=>w(null),className:"flex-1 py-2 bg-white/10 text-white rounded-xl",children:"Cancel"}),e.jsx(n.button,{whileTap:{scale:.95},onClick:C,disabled:j,className:"flex-1 py-2 bg-indigo-600 text-white rounded-xl disabled:opacity-50",children:j?"Saving...":"Save"})]})]})})]})},pe=({onBack:l})=>{const[c,s]=r.useState(""),[a,o]=r.useState("neutral"),m=()=>{console.log("Saving journal:",{entry:c,mood:a}),l()};return e.jsxs("div",{className:"flex flex-col h-full p-6 text-white overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:l,className:"mr-4 text-white/60 hover:text-white",children:"â† Back"}),e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent",children:"Daily Journal"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"How are you feeling?"}),e.jsx("div",{className:"flex gap-4",children:["ðŸ˜Š","ðŸ˜","ðŸ˜”","ðŸ˜¤","ðŸ¤”"].map(x=>e.jsx("button",{onClick:()=>o(x),className:`text-2xl p-2 rounded-full transition-all ${a===x?"bg-white/20 scale-110":"hover:bg-white/10"}`,children:x},x))})]}),e.jsx("textarea",{value:c,onChange:x=>s(x.target.value),placeholder:"Write your thoughts... or use voice input to narrate your day.",className:"flex-1 bg-black/20 rounded-xl p-4 resize-none focus:outline-none focus:ring-1 focus:ring-purple-500 mb-6"}),e.jsx("button",{onClick:m,className:"w-full py-3 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 font-semibold hover:opacity-90 transition-opacity",children:"Save Entry"})]})},D=({radius:l,thickness:c,color:s,rotationSpeed:a,segments:o=64,dashArray:m=null})=>{const x=r.useRef();K((j,N)=>{x.current&&(x.current.rotation.z+=a*N)});const p=r.useMemo(()=>new re(l-c,l,o),[l,c,o]);return e.jsx("mesh",{ref:x,geometry:p,children:e.jsx("meshBasicMaterial",{color:s,transparent:!0,opacity:.6,side:oe})})},X=({radius:l,startAngle:c,endAngle:s,color:a,pulse:o})=>{const m=r.useRef();K(p=>{m.current&&o&&(m.current.material.opacity=.3+Math.sin(p.clock.elapsedTime*2)*.3)});const x=r.useMemo(()=>{const p=new ce,j=l-.05,N=l;p.moveTo(Math.cos(c)*j,Math.sin(c)*j);const v=20;for(let w=0;w<=v;w++){const z=c+(s-c)*(w/v);p.lineTo(Math.cos(z)*N,Math.sin(z)*N)}for(let w=v;w>=0;w--){const z=c+(s-c)*(w/v);p.lineTo(Math.cos(z)*j,Math.sin(z)*j)}return new de(p)},[l,c,s]);return e.jsx("mesh",{ref:m,geometry:x,children:e.jsx("meshBasicMaterial",{color:a,transparent:!0,opacity:.7})})},ge=({affection:l=50,mood:c})=>{const s=r.useRef(),a=r.useRef(),o={happy:"#10b981",neutral:"#00d4ff",concerned:"#f59e0b",protective:"#ef4444",playful:"#ec4899",thoughtful:"#8b5cf6"},m=o[c]||o.neutral;return K(x=>{if(s.current){const p=1+Math.sin(x.clock.elapsedTime*2)*.1;s.current.scale.set(p,p,1)}a.current&&(a.current.material.opacity=.2+Math.sin(x.clock.elapsedTime*3)*.1)}),e.jsxs("group",{children:[e.jsxs("mesh",{ref:a,children:[e.jsx("circleGeometry",{args:[.4,32]}),e.jsx("meshBasicMaterial",{color:m,transparent:!0,opacity:.3})]}),e.jsxs("mesh",{ref:s,children:[e.jsx("circleGeometry",{args:[.2,32]}),e.jsx("meshBasicMaterial",{color:m})]})]})},we=({mood:l,affection:c,isActive:s})=>{const{size:a}=le();return e.jsxs("group",{children:[e.jsx(D,{radius:1.5,thickness:.02,color:"#00d4ff",rotationSpeed:.3}),e.jsx(D,{radius:1.3,thickness:.03,color:"#00d4ff",rotationSpeed:-.2}),e.jsx(D,{radius:1.1,thickness:.02,color:"#ff6b35",rotationSpeed:.4}),e.jsx(X,{radius:1.4,startAngle:0,endAngle:Math.PI*(c/100)*2,color:"#00d4ff",pulse:!0}),e.jsx(X,{radius:1.2,startAngle:Math.PI,endAngle:Math.PI*1.5,color:"#ff6b35",pulse:!0}),e.jsx(ge,{affection:c,mood:l}),[0,1,2,3].map(o=>e.jsxs("mesh",{position:[Math.cos(o*Math.PI/2)*.9,Math.sin(o*Math.PI/2)*.9,0],children:[e.jsx("circleGeometry",{args:[.03,8]}),e.jsx("meshBasicMaterial",{color:"#00d4ff"})]},o))]})},be=({mood:l,affection:c=50,isActive:s})=>e.jsxs(n.div,{initial:{opacity:0},animate:{opacity:s?.8:.4},className:"absolute inset-0 pointer-events-none",children:[e.jsxs(ne,{camera:{position:[0,0,3],fov:50},style:{background:"transparent"},gl:{alpha:!0,antialias:!0},children:[e.jsx("ambientLight",{intensity:.5}),e.jsx(we,{mood:l,affection:c,isActive:s})]}),e.jsx("div",{className:"absolute bottom-20 left-4 right-4 pointer-events-none",children:e.jsxs("div",{className:"flex justify-between text-xs font-mono text-cyan-400/60",children:[e.jsx("span",{children:"SYS: ONLINE"}),e.jsxs("span",{children:["AFFECTION: ",c,"%"]})]})})]}),fe=({mood:l,moodColor:c="#6366f1",isActive:s})=>{const a=r.useMemo(()=>{const o={happy:{color1:"#10b981",color2:"#34d399",color3:"#6ee7b7",animationSpeed:1.2},neutral:{color1:"#6366f1",color2:"#818cf8",color3:"#a5b4fc",animationSpeed:1},concerned:{color1:"#f59e0b",color2:"#fbbf24",color3:"#fcd34d",animationSpeed:.8},protective:{color1:"#ef4444",color2:"#f87171",color3:"#fca5a5",animationSpeed:1.5},playful:{color1:"#ec4899",color2:"#f472b6",color3:"#f9a8d4",animationSpeed:1.8},thoughtful:{color1:"#8b5cf6",color2:"#a78bfa",color3:"#c4b5fd",animationSpeed:.6}};return o[l]||o.neutral},[l]);return e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none overflow-hidden",children:[e.jsxs("div",{className:"relative w-48 h-48",children:[e.jsx(n.div,{className:"absolute inset-0 rounded-full blur-3xl",style:{backgroundColor:a.color1},animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},transition:{duration:4/a.animationSpeed,repeat:1/0,ease:"easeInOut"}}),e.jsx(n.div,{className:"absolute inset-4 animate-morph",style:{background:`linear-gradient(135deg, ${a.color1}, ${a.color2}, ${a.color3})`,filter:"blur(1px)"},animate:{borderRadius:["60% 40% 30% 70% / 60% 30% 70% 40%","30% 60% 70% 40% / 50% 60% 30% 60%","60% 40% 30% 70% / 60% 30% 70% 40%"],rotate:[0,180,360]},transition:{duration:8/a.animationSpeed,repeat:1/0,ease:"easeInOut"}}),e.jsx(n.div,{className:"absolute inset-8",style:{background:`linear-gradient(225deg, ${a.color2}, ${a.color3})`,filter:"blur(2px)"},animate:{borderRadius:["30% 60% 70% 40% / 50% 60% 30% 60%","60% 40% 30% 70% / 60% 30% 70% 40%","30% 60% 70% 40% / 50% 60% 30% 60%"],rotate:[360,180,0]},transition:{duration:6/a.animationSpeed,repeat:1/0,ease:"easeInOut"}}),e.jsx(n.div,{className:"absolute inset-12 rounded-full",style:{background:`radial-gradient(circle at 30% 30%, ${a.color3}, ${a.color1})`,boxShadow:`0 0 60px ${a.color1}, inset 0 0 30px rgba(255,255,255,0.2)`},animate:{scale:[1,1.1,1]},transition:{duration:2/a.animationSpeed,repeat:1/0,ease:"easeInOut"}}),e.jsx(n.div,{className:"absolute inset-16 rounded-full bg-white/20",style:{boxShadow:"inset 0 0 20px rgba(255,255,255,0.3)"},animate:{opacity:[.3,.6,.3]},transition:{duration:1.5/a.animationSpeed,repeat:1/0,ease:"easeInOut"}}),s&&e.jsx(e.Fragment,{children:[...Array(6)].map((o,m)=>e.jsx(n.div,{className:"absolute w-1 h-1 rounded-full",style:{backgroundColor:a.color3,left:"50%",top:"50%"},animate:{x:[0,Math.cos(m*60*Math.PI/180)*100],y:[0,Math.sin(m*60*Math.PI/180)*100],opacity:[1,0],scale:[1,0]},transition:{duration:2,repeat:1/0,delay:m*.3,ease:"easeOut"}},m))})]}),e.jsx(n.div,{className:"absolute bottom-24 left-0 right-0 text-center",initial:{opacity:0},animate:{opacity:.6},children:e.jsx("span",{className:"text-xs font-medium tracking-wider uppercase",style:{color:a.color2},children:l||"neutral"})})]})},je=({personaId:l="default",currentState:c="idle",mood:s="neutral",size:a="medium",className:o=""})=>{const[m,x]=r.useState(!1),[p,j]=r.useState(0),N=r.useRef(null),v=r.useRef(null),w={default:{idle:"/videos/avatar/idle_loop.webm",listening:"/videos/avatar/listening.webm",thinking:"/videos/avatar/thinking.webm",speaking:"/videos/avatar/speaking.webm",happy:"/videos/avatar/happy.webm",wave:"/videos/avatar/wave.webm"},jarvis:{idle:"/videos/jarvis/idle_loop.webm",listening:"/videos/jarvis/listening.webm",thinking:"/videos/jarvis/thinking.webm",speaking:"/videos/jarvis/speaking.webm"},kavya:{idle:"/videos/thozhi/idle_loop.webm",speaking:"/videos/thozhi/speaking.webm",listening:"/videos/thozhi/listening_nod.webm",happy:"/videos/thozhi/happy_laugh.webm",greeting:"/videos/thozhi/greeting_wave.webm",sad:"/videos/thozhi/sad_concern.webm"},arjun:{idle:"/videos/thozhan/idle.webm",speaking:"/videos/thozhan/speaking.webm"},naruto:{idle:"/videos/anime/naruto_idle.webm"},goku:{idle:"/videos/anime/goku_idle.webm"},elsa:{idle:"/videos/cartoon/elsa_idle.webm"}},z={small:"w-32 h-32",medium:"w-48 h-48",large:"w-64 h-64",fullscreen:"w-full h-full"},M=()=>{const b=w[l]||w.default;return b[c]||b.idle};return r.useEffect(()=>{p===0?N.current:v.current;const b=p===0?v.current:N.current;b&&(b.src=M(),b.load(),b.oncanplaythrough=()=>{b.play().then(()=>{j(P=>P===0?1:0)}).catch(console.error)})},[c,l]),r.useEffect(()=>{const b=N.current;b&&(b.src=M(),b.load(),b.oncanplaythrough=()=>{b.play().then(()=>x(!0)).catch(console.error)})},[]),e.jsxs("div",{className:`relative overflow-visible ${z[a]} ${o}`,children:[!m&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:e.jsx(n.div,{className:"w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}),e.jsx("video",{ref:N,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-300 ${p===0?"opacity-100":"opacity-0"}`,loop:!0,muted:!0,playsInline:!0}),e.jsx("video",{ref:v,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-300 ${p===1?"opacity-100":"opacity-0"}`,loop:!0,muted:!0,playsInline:!0}),e.jsx(F,{children:c==="listening"&&e.jsx(n.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"flex gap-1",children:[0,1,2,3,4].map(b=>e.jsx(n.div,{className:"w-1 bg-indigo-500 rounded-full",animate:{height:[8,20,8]},transition:{duration:.5,repeat:1/0,delay:b*.1}},b))})})})]})},ve=({personaId:l="jarvis",activeSkin:c="default",personalityState:s,isActive:a=!0,showVideoAvatar:o=!0})=>{const m=p=>{const j={happy:"#10b981",neutral:"#6366f1",concerned:"#f59e0b",protective:"#ef4444",playful:"#ec4899",thoughtful:"#8b5cf6"};return j[p]||j.neutral},x=()=>c==="jarvis_hud"||l==="jarvis"?e.jsx(be,{mood:s==null?void 0:s.mood,affection:s==null?void 0:s.affection,isActive:a}):o&&["kavya","arjun","tamil_nanban","naruto","goku","elsa"].includes(l)?e.jsx("div",{className:"relative w-full h-full flex items-center justify-center",children:e.jsx(je,{personaId:l,currentState:a?"listening":"idle",mood:s==null?void 0:s.mood,size:"fullscreen"})}):e.jsx(fe,{mood:s==null?void 0:s.mood,moodColor:m(s==null?void 0:s.mood),isActive:a});return e.jsx("div",{className:"absolute inset-0 pointer-events-none z-0",children:x()})},ye=({currentView:l,onViewChange:c})=>{const s=[{id:"chat",icon:"chat",label:"Chat"},{id:"journal",icon:"journal",label:"Journal"},{id:"marketplace",icon:"shop",label:"Store"},{id:"settings",icon:"settings",label:"Settings"}],a={chat:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"}),journal:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"}),shop:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"}),settings:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})};return e.jsx("div",{className:"h-14 flex items-center justify-around px-4 bg-black/20 border-t border-white/5",children:s.map(o=>e.jsxs(n.button,{onClick:()=>c(o.id),whileHover:{scale:1.1},whileTap:{scale:.9},className:`flex flex-col items-center gap-1 p-2 rounded-xl transition-all ${l===o.id?"text-indigo-400":"text-white/50 hover:text-white/80"}`,children:[e.jsxs("div",{className:"relative",children:[l===o.id&&e.jsx(n.div,{layoutId:"nav-indicator",className:"absolute inset-0 bg-indigo-500/20 rounded-lg",initial:!1,transition:{type:"spring",stiffness:500,damping:30}}),e.jsxs("svg",{className:"w-6 h-6 relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a[o.icon],o.icon==="settings"&&e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})]}),e.jsx("span",{className:"text-xs font-medium",children:o.label})]},o.id))})};r.lazy(()=>te(()=>import("./VRMAvatar-DysJ1kvm.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url));const Ne=()=>{const[l,c]=r.useState(null),[s,a]=r.useState(null),[o,m]=r.useState("chat"),[x,p]=r.useState(!0),[j,N]=r.useState(!1),[v,w]=r.useState(!1),[z,M]=r.useState(!1),[b,P]=r.useState(!1),[i,h]=r.useState(!0),[f,I]=r.useState({x:20,y:100});r.useEffect(()=>{var L,H;S();const y=(L=window.nizhal)==null?void 0:L.onPersonaChange(B=>{c(B)}),C=(H=window.nizhal)==null?void 0:H.onMoodChange(B=>{a(R=>({...R,mood:B}))});return()=>{y==null||y(),C==null||C()}},[]);const S=async()=>{var y,C;try{const L=await((y=window.nizhal)==null?void 0:y.persona.getActive()),H=await((C=window.nizhal)==null?void 0:C.persona.getState());c(L),a(H)}catch(L){console.error("Failed to initialize:",L)}finally{p(!1)}},k=r.useCallback(async()=>{var C;const y=!j;await((C=window.nizhal)==null?void 0:C.window.setClickThrough(y)),N(y)},[j]);return r.useCallback(async()=>{if(v){w(!1);return}w(!0),setTimeout(()=>{w(!1),M(!0),setTimeout(()=>{M(!1),P(!0),setTimeout(()=>{P(!1)},3e3)},2e3)},3e3)},[v]),x?e.jsx("div",{className:"h-full w-full flex items-center justify-center glass-panel",children:e.jsx(n.div,{className:"w-16 h-16 rounded-full border-4 border-primary border-t-transparent",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):e.jsxs("div",{className:"h-full w-full flex flex-col glass-panel overflow-hidden",children:[e.jsx(he,{personaName:(l==null?void 0:l.displayName)||"Nizhal AI",clickThrough:j,onClickThroughToggle:k}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[e.jsx(ve,{personaId:l==null?void 0:l.id,activeSkin:l==null?void 0:l.skin,personalityState:s,isActive:o==="chat"}),e.jsx("div",{className:"relative z-10 flex-1 overflow-hidden",children:e.jsx(F,{mode:"wait",children:e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},className:"h-full",children:[o==="chat"&&e.jsx(xe,{persona:l,personalityState:s,onListeningChange:w,onThinkingChange:M,onSpeakingChange:P}),o==="marketplace"&&e.jsx(me,{onBack:()=>m("chat")}),o==="journal"&&e.jsx(pe,{onBack:()=>m("chat")}),o==="settings"&&e.jsx(ue,{onBack:()=>m("chat"),onPersonaChange:c,showFloatingAvatar:i,onFloatingAvatarToggle:h})]},o)})})]}),e.jsx(ye,{currentView:o,onViewChange:m})]})};se.createRoot(document.getElementById("root")).render(e.jsx(ae.StrictMode,{children:e.jsx(ie,{children:e.jsx(Ne,{})})}));
